name: Project Automation

on:
  issues:
    types: [opened, closed, assigned, unassigned, labeled, unlabeled]
  pull_request:
    types: [opened, closed, merged, reopened, labeled, unlabeled]

permissions:
  issues: write
  pull-requests: write
  contents: write
  projects: write

jobs:
  update-project-status:
    runs-on: ubuntu-latest
    if: github.event_name == 'issues' || github.event_name == 'pull_request'
    
    steps:
    - uses: actions/checkout@v4

    - name: Update project card status
      uses: actions/github-script@v7
      with:
        script: |
          const { issue, pull_request } = context.payload;
          const item = issue || pull_request;
          
          if (!item) {
            console.log('No item found in payload');
            return;
          }
          
          console.log(`Processing ${context.eventName} event for ${item.number}`);
          
          // For now, just add a comment to test the workflow
          try {
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: item.number,
              body: `ðŸ”„ **Project Automation Test**: Workflow is running for ${context.eventName} #${item.number}`
            });
            console.log(`Added test comment to ${context.eventName} #${item.number}`);
          } catch (error) {
            console.log(`Failed to add comment: ${error.message}`);
          }
